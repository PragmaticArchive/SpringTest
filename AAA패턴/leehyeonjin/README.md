# AAA 패턴

---

### AAA 패턴 / GWT 패턴

테스트에서 AAA(Arrange-Act-Assert) 패턴은 테스트 케이스를 작성할 때 사용하는 구조적인 접근방법.

**AAA 패턴의 단계**

1. Arrange(준비) 단계 : 테스트를 수행하기 위해 필요한 초기 상태를 설정. 이 단계에서는 테스트할 객체나 변수를 초기화하고, 필요한 데이터를 설정하며, 테스트 환경을 구성함.
2. Act(실행) 단계 : 테스트 대상 코드를 실행. 이 단계에서는 실제로 테스트할 메서드나 함수를 호출하고, 특정 동작을 수행함.
3. Assert(단언) 단계 : 예상되는 결과를 확인하고 검증함. 이 단계에서는 실행된 코드의 결과나 상태를 기대한대로 확인하여 테스트가 성공했는지 여부를 판단. 예상된 결과와 실제 결과를 비교하고, 일치하지 않는 경우에는 테스트를 실패로 표시함.

AAA 패턴은 테스트 코드를 구조화하여 가독성을 높이고, 테스트의 목적과 결과를 명확하게 전달하는데 도움을 줌. 이 패턴을 사용하면 테스트 케이스를 일관성 있고 구조화된 방식으로 작성할 수 있으며, 테스트 코드의 유지 보수성을 향상시킬 수 있음.

> 💡 **GWT 패턴**
>
> GWT 패턴의 구성요소들은 각각 Given → Arrange, When → Act, Then → Assert에 대응됨.

---

### xUnit과 jUnit

xUnit은 테스트 도구에서 사용되는 테스트 프레임워크의 일종.

xUnit은 다양한 프로그래밍 언어를 지원하며, 테스트 작성, 실행, 결과 분석 등을 효과적으로 수행할 수 있도록 도와줌.

xUnit은 테스트 주도 개발(Test-Driven Development, TDD) 및 애자일 개발 방법론에서 널리 사용됨.

xUnit은 이름의 뒷부분에 ‘Unit’이라는 용어를 가지고 있는데, 이는 초기에는 단위 테스트를 위해 설계되었지만, 현재는 단위 테스트 뿐만 아니라 통합 테스트, 시스템 테스트 등 다양한 수준의 테스트를 지원.

여러가지 xUnit 도구가 있지만, 그 중에서도 가장 잘 알려진 것은 JUnit(Java), PHPUnit(PHP) 등임.
</br></br>

**xUnit 프레임워크의 주요 특징**

1. 테스트 케이스 작성 :
- xUnit은 테스트 케이스를 작성할 수 있는 기본적인 구조와 어노테이션을 제공함.
- 개발자는 테스트 메서드를 작성하고, 어노테이션을 사용하여 테스트를 구성할 수 있음.
1. 테스트 실행 :
- xUnit은 테스트 케이스를 실행하고 테스트 결과를 수집하는 런치 또는 테스트 실행기를 제공함.
- 이를 통해 테스트를 자동으로 실행하고, 예외 처리 및 테스트 결과를 기록할 수 있음.
1. 단언(Assertion) :
- xUnit은 단언(assertion) 메서드를 통해 예상 결과와 실제 결과를 비교하여 테스트 결과를 확인함.
- 이를 통해 코드의 동작이 예상대로 수행되고 있는지를 검증.
1. 테스트 결과 분석 :
- xUnit은 테스트 결과를 분석하고 요약하여 제공함.
- 성공한 테스트, 실패한 테스트, 테스트 커버리지 등의 정보를 통해 테스트의 진행 상황과 코드의 품질을 판단할 수 있음.

xUnit 프레임워크는 소프트웨어 테스트의 자동화와 품질 향상을 위해 많이 사용되며, 테스트 주도 개발과 같은 개발 방법론과 함께 사용될 때 가장 효과적으로 활용됨.

JUnit 5는 Java 언어를 위한 테스트 프레임워크로서, 단위 테스트를 작성하고 실행하는 데 사용됨. JUnit은 소프트웨어 개발자들이 자동화된 테스트를 작성하여 코드의 정확성을 검증하고, 버그를 발견하고, 소프트웨어의 안정성을 향상시키는 데 도움을 줌.

---

### JUint 연습하기

**자주 사용하는 것들**

```java
assertEquals() // 두 값이 동일한지 확인
assertNotEquals() // 두 값이 다른지 확인
assertTrue() // 조건이 참인지 확인
assertFalse() // 조건이 참인지 확인
assertNull() // 값이 null인지 확인
assertThrows() // 예외가 발생하는지 확인
assertNotNull() // 값이 null이 아닌지 확인
assertIterableEquals() // 두 Iterable 객체가 동일한 요소를 포함하고 있고, 순서도 같은지 확인
assertAll() // 여러 어설션을 그룹화하여 모두 실행하고, 실패한 경우에도 나머지 어설션들을 계속 실행
```

**시간 검증**

```java
assertTimeout() // 특정 작업이 지정된 시간 내에 완료되는지 확인
assertTimeoutPreemptively() // 특정 작업이 지정된 시간 내에 완료되는지 확인하며, 작업이 시간 초과되면 즉시 중단

Assertions.assertTimeoutPreemptively(Duration.ofSeconds(1), () -> {
	// 1초 이내에 완료되어야 함
	Thread.sleep(500);
});
```

**그 외**

```java
assertSame() // 두 객체가 동일한 객체인지 확인
assertNotSame() // 두 객체가 서로 다른 객체인지 확인
assertArrayEquals() // 두 배열이 동일한지 확인
assertDoesNotThrows() // 예외가 발생하지 않는지 확인
assertLinesMatch() // 두 문자열 리스트가 동일한 라인 순서와 패턴을 갖는지 확인
```

**JUnit 기능 익히기**

```java
// 테스트에 이름 붙이기
@DisplayNameGeneration
@DisplayName

// 테스트 반복하기
@RepeatedTest
@ParameterizedTest

// 순서대로 실행하기
@TestMethodOrder
@Order
@BeforeEach
@AfterEach
@BeforeAll
@AfterAll
```

> 💡 현업에서 경험해보니 `@Order` `@TestMethodOrder` 어노테이션 들은 가능한 사용하지 않는 것이 좋음. 
> 
> 만약 불가피하게 필요한 상황이 발생했다면, 코드나 테스트 환경이 완전히 격리되어 있지 않거나, 멱등하지 않은 경우일 확률이 높음.
>
> 즉 위 어노테이션들이 필요한 상황 자체를 좋지 않은 코드 환경의 휴리스틱 지표로 볼 수 있음.
